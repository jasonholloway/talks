<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Deconstructors</title>
<meta name="author" content="jason"/>
<meta name="description" content="blah blah blah"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="./reveal.js/css/reveal.css"/>

<link rel="stylesheet" href="./reveal.js/css/theme/sunblind.css" id="theme"/>

<link rel="stylesheet" href="./custom.css"/>
<link rel="stylesheet" href="./reveal.js/lib/css/zenburn.css"/>

<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = './reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section>
<section id="slide-1">
<h2 id="1"><span class="section-number-2">1</span> </h2>
<div class="org-src-container">

<pre><code class="C#" >
var thing = new Thing("blah", 123);

</code></pre>
</div>

</section>
</section>
<section>
<section id="slide-2">
<h2 id="2"><span class="section-number-2">2</span> Constructors <span class="mini-exclaim">(woo!)</span></h2>
<div class="org-src-container">

<pre><code class="C#" >
var thing = new Thing("blah", 123);

</code></pre>
</div>
<aside class="notes">
<p>
that's the end of the talk (joke)
</p>

<p>
an args list: the simplest possible construction of values, shoveled in to type constructor
and you get out, a thing
</p>

<p>
the construction does two things, to different degrees
</p>

<p>
this is kind of what we get by default, as we're just, as I said, shovelling in this simple list of values into the constructor
how this type converts these values into the properties and methods it exposes is necessarily up to it, as we've delegated compete control to it
we're operating entirely on trust
</p>

<p>
but there's another side to how we expect them to work&#x2026;
</p>

<p>
encapsulation=delegation and packing=trust
</p>

</aside>

<ul>
<li class="fragment roll-in">encapsulates</li>
<li class="fragment roll-in">packs</li>

</ul>



</section>
</section>
<section>
<section id="slide-3">
<h2 id="3"><span class="section-number-2">3</span> ctors <i><span class="underline">Encapsulate</span></i></h2>
<ul>
<li class="fragment roll-in"><p>
data is opaquely wrapped
 <div class="dog-box">
</p>
<div class="org-src-container">

<pre><code class="C#" >
var dog = new Dog(name: "Bruce", loyalty: 0.37, enthusiasm: 0.76);

//now parameters are the dog's business...

</code></pre>
</div>
<p>
<img src="./dog1.jpg" alt="dog1.jpg" />
 </div>
</p></li>

<li class="fragment roll-in"><p>
and behaviour is exposed
 <div class="dog-box">
</p>
<div class="org-src-container">

<pre><code class="C#" >
//our business is limited to the contract

var stick = dog.FetchStick();

</code></pre>
</div>
<p>
 <img src="./dog2.jpg" alt="dog2.jpg" />
 </div>
</p></li>

</ul>

</section>
</section>
<section>
<section id="slide-4">
<h2 id="4"><span class="section-number-2">4</span> ctors <i><span class="underline">Pack</span></i></h2>
<ul>
<li class="fragment roll-in"><p>
data is transparently structured
</p>
<div class="org-src-container">

<pre><code class="C#" >class Dog
{
	public FetchResult FetchStick()
	{
		return new FetchResult(
			success: true,
			stick: new Stick(variety: Wood.Birch, weight: 0.23)
		);
	}
}
</code></pre>
</div></li>
<li class="fragment roll-in"><p>
to be unpacked later
</p>
<div class="org-src-container">

<pre><code class="C#" >
var fetched = dog.FetchStick();

if(fetched.Success)
{
	Write($"Wow, this stick is {fetched.Stick.Weight} kilogrammes in weight!");
}

</code></pre>
</div></li>

</ul>

</section>
</section>
<section>
<section id="slide-5">
<h2 id="5"><span class="section-number-2">5</span> Illustrative picture</h2>

<div id="org1b88a74" class="figure">
<p><img src="./dogstick.jpg" alt="dogstick.jpg" />
</p>
</div>


</section>
</section>
<section>
<section id="slide-6">
<h2 id="6"><span class="section-number-2">6</span> C# Syntax</h2>
<p>
that's the semantics of it&#x2026;
C# syntax has always supported both, but asymetrically
</p>

</section>
</section>
<section>
<section id="slide-7">
<h2 id="7"><span class="section-number-2">7</span> The rising tide of pack/unpack</h2>

<div id="org3b1c171" class="figure">
<p><img src="./dogsurf.jpg" alt="dogsurf.jpg" />
</p>
</div>

</section>
</section>
<section>
<section id="slide-8">
<h2 id="8"><span class="section-number-2">8</span> C#3 Prop-Packing</h2>
<ul class="fragment roll-in">
<li><p>
object initializers - set properties directly
</p>
<div class="org-src-container">

<pre><code class="C#" >//caller dictates props
var meal = new Dinner
{
	Main = new MeatInGravy(),
	Dessert = new DryBiscuits()
};
</code></pre>
</div></li>

</ul>
<ul class="fragment roll-in">
<li><p>
needed by anonymous objects, essential to LINQ
</p>
<div class="org-src-container">

<pre><code class="C#" >return new 
{
	Decibels = 90,
	Voice = "yapyapyap"
};
</code></pre>
</div></li>

</ul>
<ul class="fragment roll-in">
<li><p>
props go in, props come out: symmetry!
</p>
<div class="org-src-container">

<pre><code class="C#" >barks
	.Where(x =&gt; x.Voice == "yapyapyap")
	.Select(_ =&gt; "could be a poodle?");
</code></pre>
</div></li>

</ul>
<aside class="notes">
<ul>
<li>not about encapsulation!</li>

</ul>

</aside>

</section>
</section>
<section>
<section id="slide-9">
<h2 id="9"><span class="section-number-2">9</span> C#7 Type-Unpacking</h2>
<aside class="notes">
<ul>
<li>C#5 had been about async - now we're back to syntax&#x2026;</li>
<li>nascent symettry&#x2026;</li>
<li>type param goes in, type param comes out</li>

</ul>

</aside>

<ul class="fragment roll-in">
<li><p>
allows us to probe the type used to construct the object
</p>
<div class="org-src-container">

<pre class="fragment roll-in"><code class="C#" >if(pet is Dog dog)
{
	Beckon(dog.Name);
}
else
{
	//...
}
</code></pre>
</div></li>

</ul>

<div class="org-src-container">

<pre class="fragment roll-in"><code class="C#" >switch(pet)
{
	case Dog dog:
		Beckon(dog.Name);
		break;

	case Cat cat:
		PutOutSomeFood();
		WaitForAges();
		break;
}
</code></pre>
</div>
<ul class="fragment roll-in">
<li>types go in, types come out: symmetry!</li>

</ul>

</section>
</section>
<section>
<section id="slide-10">
<h2 id="10"><span class="section-number-2">10</span> C#7 Deconstructors</h2>
<ul class="fragment roll-in">
<li>allow us to unpack both <b>type</b> <i>and</i> <b>arg list</b></li>

</ul>
<div class="org-src-container">

<pre class="fragment roll-in"><code class="C#" >var pets = new[]
{
	new Dog("Graham", 13),
	new Cat("Tabitha", Foods.Kippers)
};

//...

switch(pet)
{
	case Dog(var name, _):
		CallOut(name);
		break;

	case Cat(_, var faveFood):
		PutOutSomeFood(faveFood);
		break;
}
</code></pre>
</div>
<ul class="fragment roll-in">
<li>amazing symmetry achieved!</li>

</ul>

</section>
</section>
<section>
<section id="slide-11">
<h2 id="11"><span class="section-number-2">11</span> Dog looking at itself in a mirror</h2>
<p>
switch and 'is Type' statements are clear reflections of the syntax used to construct the type in the first place
</p>

<p>
Pic of dog here please
</p>



</section>
</section>
<section>
<section id="slide-12">
<h2 id="12"><span class="section-number-2">12</span> demo of implementing deconstructor&#x2026;</h2>
<div class="outline-text-2" id="text-12">
</div>
</section>
<section id="slide-12-1">
<h3 id="12-1"><span class="section-number-3">12.1</span> 2016</h3>
<p>
what happened in 2016?
</p>

</section>
<section id="slide-12-1-1">
<h4 id="12-1-1"><span class="section-number-4">12.1.1</span> Tuples!</h4>
<p>
is like an args list without the type
</p>

</section>
<section id="slide-12-1-2">
<h4 id="12-1-2"><span class="section-number-4">12.1.2</span> But also introduced new ways of unpacking data</h4>
<div class="outline-text-4" id="text-12-1-2">
</div>
<ol class="org-ol">
<li><a id="12-1-2-1"></a>type matching (which is unpacking if you squint)<br /></li>

<li><a id="12-1-2-2"></a>pattern-matching of tuples<br />
<ol class="org-ol">
<li><a id="12-1-2-2-1"></a>brilliant symmetry of tuples - so simple and so obvious<br />
<p>
like a pivot to a different way of seeing objects - pack/unpack
crystal clear
</p>
</li>
</ol>
</li>

<li><a id="12-1-2-3"></a>Deconstructors<br />
<ol class="org-ol">
<li><a id="12-1-2-3-1"></a>tuples desugared<br />
<p>
tuples carry the minimum amount of baggage, purest containers
</p>
</li>

<li><a id="12-1-2-3-2"></a>demo of desconstructed type pattern matching<br />
<div class="org-src-container">

<pre><code class="C#" >switch(thing) {

	case Thing("blah"):
	 break;

	case Thing("blahdy blah"):
	 break;

}
</code></pre>
</div>
</li>
</ol>
</li>
</ol>


</section>
</section>
<section>
<section id="slide-13">
<h2 id="13"><span class="section-number-2">13</span> The present/future</h2>
<div class="outline-text-2" id="text-13">
</div>
</section>
<section id="slide-13-1">
<h3 id="13-1"><span class="section-number-3">13.1</span> auto property deconstructuring</h3>
<div class="outline-text-3" id="text-13-1">
</div>
</section>
<section id="slide-13-1-1">
<h4 id="13-1-1"><span class="section-number-4">13.1.1</span> just syntactical repackaging really</h4>

</section>
<section id="slide-13-1-2">
<h4 id="13-1-2"><span class="section-number-4">13.1.2</span> but forms symmetrical pair with object initializers</h4>
<p>
just like how ctors with an args list tuple get unpacked
</p>

</section>
<section id="slide-13-2">
<h3 id="13-2"><span class="section-number-3">13.2</span> init-only setters</h3>

</section>
<section id="slide-13-3">
<h3 id="13-3"><span class="section-number-3">13.3</span> and finally, records</h3>
<div class="outline-text-3" id="text-13-3">
</div>
</section>
<section id="slide-13-3-1">
<h4 id="13-3-1"><span class="section-number-4">13.3.1</span> kind of templated data-carrying classes</h4>

</section>
<section id="slide-13-3-2">
<h4 id="13-3-2"><span class="section-number-4">13.3.2</span> intended to be used with pattern-matching</h4>
<div class="outline-text-4" id="text-13-3-2">
</div>
<ol class="org-ol">
<li><a id="13-3-2-1"></a>like anon objects v2<br /></li>
</ol>

</section>
<section id="slide-13-3-3">
<h4 id="13-3-3"><span class="section-number-4">13.3.3</span> culmination of data-type story</h4>
</section>
</section>
</div>
</div>
<script src="./reveal.js/js/reveal.js"></script>
<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: false,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
mouseWheel: false,
fragmentInURL: false,
hashOneBasedIndex: false,
pdfSeparateFragments: true,
overview: true,

theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
transition: Reveal.getQueryHash().transition || 'None', // see README of reveal.js for options
transitionSpeed: 'default',

// Optional libraries used to extend reveal.js
dependencies: [
 { src: './reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }]

,slideNumber: 'h.v', hash: true,});
</script>
</body>
</html>
